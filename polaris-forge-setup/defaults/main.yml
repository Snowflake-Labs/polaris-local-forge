# Copyright 2025 Snowflake Inc.
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# defaults/main.yml
---
# CLI / Infrastructure Defaults
# These are used by both CLI (cli.py) and Ansible playbooks
plf_cluster_name: polaris-local-forge
plf_k3s_version: v1.35.1-k3s1
# Container Runtime Detection priority: running Docker > running Podman > installed Podman > installed Docker
plf_podman_machine: k3d

# AWS S3-Compatible Storage Configuration (RustFS)
# External endpoint for Ansible tasks (localhost via NodePort 19000:31900)
plf_aws_endpoint_url: http://localhost:19000
# Internal endpoint for Polaris (inside k8s cluster)
# Service name is 'rustfs-svc' in namespace 'rustfs' - internal port stays 9000
plf_aws_endpoint_url_internal: http://rustfs-svc.rustfs:9000
plf_aws_region: us-east-1 # AWS region for RustFS
plf_aws_role_arn: arn:aws:iam::000000000000:role/Admin # Default role ARN
plf_aws_access_key_id: admin # AWS_ACCESS_KEY_ID (RustFS root user)
plf_aws_secret_access_key: password # AWS_SECRET_ACCESS_KEY (RustFS root password)

# Polaris API Configuration
plf_api_host: localhost # Polaris API host
plf_api_port: 18181 # Default Polaris API port
plf_realm: POLARIS # Polaris realm name
plf_api_base_url: "http://{{ plf_api_host }}:{{ plf_api_port }}" # Polaris API URL

# Catalog Configuration
plf_catalog_name: polardb # Name of the Polaris catalog
plf_base_s3_location: "s3://{{ plf_catalog_name }}" # S3 location for catalog storage
plf_aws_path_style_access: true # AWS path style access

# Security Configuration
plf_admin_username: super_user # Superuser for Polaris
plf_admin_role: admin # Admin role name
plf_catalog_role: sudo # Catalog role name

# File System Configuration
# plf_output_base controls where generated files are written.
# Override with -e plf_output_base=/path/to/work/dir to redirect output
# away from the source tree (used by --work-dir in the CLI).
plf_output_base: "{{ playbook_dir }}/.." # default: repo root (backward compatible)
plf_work_dir: "{{ plf_output_base }}/work"
plf_k8s_dir: "{{ plf_output_base }}/k8s"
plf_polaris_dir: "{{ plf_k8s_dir }}/polaris"
plf_features_dir: "{{ plf_k8s_dir }}/features"
plf_credentials_file: "{{ plf_k8s_dir }}/polaris/.bootstrap-credentials.env"
plf_notebook_dir: "{{ plf_output_base }}/notebooks"
plf_scripts_dir: "{{ plf_output_base }}/scripts"
# Template dir always points to the skill repo (read-only source)
plf_template_dir: "{{ playbook_dir }}/templates"

# Polaris Metastore configuration
plf_jpa_persistence_unit_name: polaris-dev
plf_jdbc_username: postgres
plf_polaris_database: polaris
plf_jdbc_url: "jdbc:postgresql://postgresql:5432/{{ plf_polaris_database }}"

## Verification config
plf_demo_db: demo_db
plf_demo_table: fruits
